# IngestParserTest
Simple utility that uses ADSIngestParser to parse publisher metadata into ADS Ingest_Data_Model json


# Create an environment
Using anaconda, create a python3.8 virtual environment.  Assuming you are on adsnest in a working directory you've created:

```
anaconda_activate ; python -m venv venv ; anaconda_deactivate ; source venv/bin/activate.csh
python -m pip install -r requirements.txt
```

# Parse an input metadata file into Ingest_Data_Model JSON

```
python run.py -f input.xml -t [TYPE] # [TYPE] one of 'jats', 'nlm', 'dc', 'cr', 'elsevier'
```

If successful, the file will be written to `./input.xml.json`


# Notes

- You need to know ahead of time what the file type is (JATS, DataCite XML, Elsevier, etc.)
- Some XML files may have both "NLM" and "JATS" in the header: use 'jats'
- The DataCite and Crossref parsers are for Crossref-XML generated by their endpoint. (See https://github.com/adsabs/ADSManualParser/blob/main/adsmanparse/doiharvest.py)
- Other parsers will be added to this as they become available.


# Example workflow

- Log on to adsnest
- create a new working directory for yourself, e.g. `mkdir /proj/ads/adstmp/parsing_fun`
- `cd /proj/ads/adstmp/parsing_fun`
- `git clone https://github.com/adsabs/IngestParserTest.git`
- `cd IngestParserTest`
- `anaconda_activate ; python -m venv venv ; anaconda_deactivate ; source venv/bin/activate.csh`
- `python -m pip install -r requirements.txt`
- Try an example Springer file:
- `python run.py -t jats -f /proj/ads/abstracts/sources/SPRINGER/files/JOU=13130/VOL=2023.2023/ISU=7/ART=21411/13130_2023_Article_21411_nlm.xml`

The output should be:

```
Parsing succeeded.  Results:
	Parser type: jats
	Infile: /proj/ads/abstracts/sources/SPRINGER/files/JOU=13130/VOL=2023.2023/ISU=7/ART=21411/13130_2023_Article_21411_nlm.xml
	Outfile: ./13130_2023_Article_21411_nlm.xml.json
```
